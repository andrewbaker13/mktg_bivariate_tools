<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Chi-Square Test of Independence</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="../../../shared/css/main.css">
    <script src="../../../shared/js/tracking.js"></script>
    <link rel="stylesheet" href="../../../shared/css/auth_bar.css">
    <link rel="stylesheet" href="main_chisquare.css">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-290ZJ9RE04"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-290ZJ9RE04');
    </script>
  </head>
  <body>
    <div class="auth-bar">
      <div class="auth-bar__container">
        <div></div>
        <div id="auth-bar-content" class="auth-bar__links">
          <a href="../../../admin_pages/login.html">Login</a>
          <a href="../../../admin_pages/register.html">Create Account</a>
        </div>
      </div>
    </div>
    <main class="app-main">
      <header class="intro hero-header">
        <div class="hero-header__top">
          <h1>Chi-Square Test of Independence</h1>
          <div class="hero-context">
            <span class="badge">Crosstab tool</span>
          </div>
        </div>
        <p class="hero-header__lede">Explore whether two categorical variables are associated using a contingency table. Enter the observed counts below; we compute expected counts, &chi;&sup2;, df, p-value, and an interpretation.</p>
      </header>

      <!-- Professor Mode Banner -->
      <div class="professor-mode-banner">
          <div class="professor-mode-content">
              <div class="professor-mode-info">
                  <h3>üë®‚Äçüè´ Professor Mode: Guided Learning Experience</h3>
                  <p>New to chi-square tests? Enable Professor Mode for step-by-step guidance through testing independence between categorical variables!</p>
              </div>
              <label class="professor-mode-toggle">
                  <input type="checkbox" id="professorMode">
                  <span>Enable Professor Mode</span>
              </label>
          </div>
      </div>

      <section class="test-overview" id="tut-overview-section">
        <h2 class="section-label">TEST OVERVIEW &amp; EQUATIONS</h2>
        <div class="card">
          <p>Use this tool to determine whether the distribution of one categorical variable differs across the levels of another. In marketing, this helps validate whether response rates shift across creative, channel, or audience slices.</p>
          <p class="equation">
            <strong>Chi-square statistic:</strong>
            $$\chi^2 = \sum_{i=1}^{r} \sum_{j=1}^{c} \frac{(O_{ij} - E_{ij})^2}{E_{ij}}$$
          </p>
          <p class="equation">
            <strong>Expected cell count:</strong>
            $$E_{ij} = \frac{(\text{Row}_i \text{ total})(\text{Col}_j \text{ total})}{\text{Grand total}}$$
          </p>
          <details class="intro-notes" style="margin-top:12px;">
            <summary>Additional notes</summary>
            <p>Chi-square approximations are most reliable when each expected count exceeds 5. When sparse cells remain, consider combining categories or switching to an exact or simulation-based procedure.</p>
          </details>
        </div>
      </section>

      <section class="scenario-section" id="tut-scenario-section">
        <h2>MARKETING SCENARIOS</h2>
        <div class="card">
          <div class="scenario-controls">
            <label for="scenario-select">Choose a preset scenario</label>
            <select id="scenario-select">
              <option value="">Manual inputs (no preset)</option>
            </select>
            <button id="scenario-download" class="secondary hidden" type="button" disabled>Download scenario dataset</button>
          </div>
          <div id="scenario-description">
            <p>Pick a scenario to auto-fill the contingency table and narrative with real marketing counts from curated analyses. Switch back to manual inputs if you want to customize the numbers further.</p>
          </div>
        </div>
      <section class="inputs-panel" id="tut-input-section">
        <h2>INPUTS &amp; SETTINGS</h2>
        <div class="card data-entry-card">
          <div class="input-header">
            <h3>Select Data Entry / Upload Mode</h3>
          </div>
          <div class="mode-toggle" role="tablist" aria-label="Data entry mode">
            <button type="button" class="mode-button active" data-mode="manual">Manual entry</button>
            <button type="button" class="mode-button" data-mode="summary-upload">Upload contingency table</button>
            <button type="button" class="mode-button" data-mode="raw-upload">Upload raw data</button>
          </div>
          <div class="mode-panels">
            <div class="mode-panel active" data-mode="manual" id="manual-panel">
              <div class="controls-container">
                <article class="manual-card">
                  <h3>Design your table</h3>
                  <div class="control-group" style="display:flex; gap:16px; flex-wrap:wrap;">
                    <div style="flex:1 1 160px;">
                      <label for="rows">Rows</label>
                      <input id="rows" type="number" min="2" max="10" value="2" />
                    </div>
                    <div style="flex:1 1 160px;">
                      <label for="cols">Columns</label>
                      <input id="cols" type="number" min="2" max="10" value="2" />
                    </div>
                  </div>
                  <div class="control-group" style="margin-top:12px;">
                    <button id="clearTable" class="secondary">Clear inputs</button>
                  </div>
                </article>
                <article class="manual-card">
                  <h3>Observed Counts</h3>
                  <div id="tableContainer"></div>
                  <p id="assumptionNote" class="plain-language"></p>
                  <div class="control-group">
                    <label for="cellLabelMode">Cell Labels Reporting Options</label>
                    <select id="cellLabelMode">
                      <option value="none">None</option>
                      <option value="observed">Observed</option>
                      <option value="expected">Expected</option>
                      <option value="row_pct">Row %</option>
                      <option value="col_pct">Column %</option>
                      <option value="table_pct">Table %</option>
                    </select>
                    <div class="plain-language">Shows a small label under each input.</div>
                  </div>
                  <div style="margin: 10px 0; display:flex; gap:8px; align-items:center;">
                    <button id="toggleEditLabels" class="secondary">Edit Row/Column Names</button>
                  </div>
                </article>
              </div>
              <div class="template-buttons" style="margin-top:12px;">
                <button id="download-inputs" class="secondary" type="button">Download current inputs</button>
              </div>
            </div>
            <div class="mode-panel" data-mode="summary-upload" id="summary-panel">
              <div class="data-import-block">
                <h3>Upload a contingency table</h3>
                <p class="plain-language">Provide a CSV/TSV where the first row lists column headers, the first column lists row labels, and every other cell contains observed counts.</p>
                <div id="crosstab-dropzone" class="dropzone" role="button" tabindex="0">
                  <p class="dropzone-title">Drag &amp; Drop raw data file (.csv, .tsv, .txt)</p>
                  <p class="dropzone-note">Contingency table format: first row = column headers, first column = row labels, remaining cells = counts.</p>
                  <button type="button" id="summary-browse" class="secondary">Browse files</button>
                </div>
                <input type="file" id="crosstab-file-input" accept=".csv,.tsv,.txt" hidden />
                <div class="template-buttons">
                  <button type="button" id="summary-template-download">Download 3&times;4 template</button>
                </div>
                <p id="summary-upload-status" class="upload-status">No contingency table uploaded yet.</p>
              </div>
            </div>
            <div class="mode-panel" data-mode="raw-upload" id="raw-panel">
              <div class="data-import-block">
                <h3>Upload raw data</h3>
                <p class="plain-language">Upload row-level observations with exactly two columns (category for variable A, category for variable B). We will aggregate them into a contingency table.</p>
                <div id="raw-dropzone" class="dropzone" role="button" tabindex="0">
                  <p class="dropzone-title">Drag &amp; Drop raw data file (.csv, .tsv, .txt)</p>
                  <p class="dropzone-note">Two categorical columns with headers (Variable A, Variable B); up to 2,000 rows.</p>
                  <button type="button" id="raw-browse" class="secondary">Browse files</button>
                </div>
                <input type="file" id="raw-file-input" accept=".csv,.tsv,.txt" hidden />
                <div class="template-buttons">
                  <button type="button" id="raw-template-download">Download raw template</button>
                </div>
                <p id="raw-upload-status" class="upload-status">No raw file uploaded yet.</p>
              </div>
            </div>
          </div>
          <article class="manual-card reporting-card" style="margin-top:16px;">
            <h3>Confidence Level &amp; Advanced Settings</h3>
            <div class="confidence-buttons" id="chi-confidence-buttons" role="group" aria-label="Select confidence level">
              <button type="button" class="confidence-button" data-level="0.90">90% Conf.</button>
              <button type="button" class="confidence-button active" data-level="0.95">95% Conf.</button>
              <button type="button" class="confidence-button" data-level="0.99">99% Conf.</button>
            </div>
            <div class="input-group" style="margin-top:12px;">
              <label for="alpha">Significance level (&alpha;)</label>
              <input type="number" id="alpha" min="0.001" max="0.25" step="0.005" value="0.05">
            </div>
            <details class="advanced-settings persistent-advanced" style="margin-top:10px;">
              <summary>Advanced settings</summary>
              <div class="plain-language" style="margin:6px 0 8px;">Options for special cases and small samples.</div>
              <label style="display:block; margin-top:6px;">
                <input id="yates" type="checkbox" />
                Yates continuity correction (2&times;2 only)
              </label>
              <div class="plain-language">Use for small-sample 2&times;2 tables to reduce bias.</div>
            </details>
          </article>
        </div>
      </section>

      <section class="visual-output" id="tut-visual-section">
        <h2>VISUAL OUTPUT</h2>
        <div class="card">
          <article class="chart-card">
            <h3>Stacked 100% Bar Chart</h3>
            <div id="chartCaption" class="plain-language"></div>
            <div class="chart-stage">
              <div id="stackedChart" class="chart-placeholder"></div>
              <div id="chartTooltip" class="chart-tooltip" style="display:none;"></div>
            </div>
            <div id="chartLegend" class="chart-legend"></div>
          </article>
          <details class="visual-output-settings">
            <summary>Visualization Settings</summary>
            <div class="visualization-options__body">
              <div class="control-group">
                <label for="chartXAxis">Chart X-axis variable</label>
                <select id="chartXAxis">
                  <option value="rows">Rows on X (stack by columns)</option>
                  <option value="columns">Columns on X (stack by rows)</option>
                </select>
                <div class="plain-language">Bars show 100% stacked proportions by the chosen X variable.</div>
              </div>
              <div class="control-group">
                <button id="flipStackOrder" class="secondary" type="button">Flip stack order</button>
                <p class="plain-language" style="margin:4px 0 0;">Reverse the stacking so the bottom segment moves to the top.</p>
              </div>
            </div>
          </details>
        </div>
      </section>

      <section class="test-results" id="tut-results-section" aria-labelledby="test-results-heading">
        <h2 id="test-results-heading">TEST RESULTS</h2>
        <div class="card metrics-panel">
          <div class="metric-output">Chi-square (&chi;&sup2;): <span id="chi2" class="dynamic-value">&ndash;</span></div>
          <div class="metric-output">Degrees of freedom: <span id="df" class="dynamic-value">&ndash;</span></div>
          <div class="metric-output">p-value (upper tail): <span id="pValue" class="dynamic-value">&ndash;</span></div>
          <div class="metric-output">Effect size (Cram&eacute;r's V): <span id="cramerV" class="dynamic-value">&ndash;</span></div>
          <div class="metric-output">Decision (&alpha;): <span id="decision" class="dynamic-value">&ndash;</span></div>
          <div class="metric-output">Interpretation: <span id="interpretation">&ndash;</span></div>
        </div>

        <div class="dual-panels">
          <article class="card dual-panel">
            <h3>APA-Style Statistical Reporting</h3>
            <p id="apaReport"></p>
          </article>
          <article class="card dual-panel">
            <h3>Managerial Interpretation</h3>
            <p id="managerInterpretation"></p>
          </article>
        </div>
      </section>

      <section class="diagnostics-section">
        <h2>DIAGNOSTICS &amp; ASSUMPTIONS</h2>
        <div class="card">
          <details class="diagnostics-details">
            <summary>Diagnostics &amp; Assumption Tests</summary>
            <div id="diagnostics-content">
              <p class="muted">Enter observed counts to check sample size, expected counts, and leverage diagnostics.</p>
            </div>
          </details>
        </div>
        <div class="card expected-table">
          <h3>Expected Counts</h3>
          <div id="expectedContainer" class="mini-table"></div>
          <details style="margin-top:8px">
            <summary>What are expected counts?</summary>
            <p class="plain-language">Under the null hypothesis (independence), the expected count for each cell is what we would anticipate from the row and column totals alone. These expected values are used in the chi-square statistic by comparing observed and expected counts and summing the squared differences scaled by the expected value: &chi;&sup2; = &Sigma;<sub>i,j</sub> <span class="frac"><span class="num">(O<sub>ij</sub> &minus; E<sub>ij</sub>)&sup2;</span><span class="den">E<sub>ij</sub></span></span>. When many expected counts are small (e.g., &lt; 5), results should be interpreted with caution.</p>
          </details>
        </div>
      </section>

      <!-- Edit Panel -->
      <div id="editPanel" class="edit-panel" style="display:none;">
        <div class="edit-dialog">
          <h3 style="margin-top:0">Edit Names</h3>
          <div class="control-group">
            <label for="editRowVar">Row variable name</label>
            <input id="editRowVar" type="text" />
          </div>
          <div class="control-group">
            <label for="editColVar">Column variable name</label>
            <input id="editColVar" type="text" />
          </div>
          <div class="control-group">
            <label for="editRowLabels">Row labels (comma-separated)</label>
            <input id="editRowLabels" type="text" />
          </div>
          <div class="control-group">
            <label for="editColLabels">Column labels (comma-separated)</label>
            <input id="editColLabels" type="text" />
          </div>
          <div style="display:flex; gap:8px; justify-content:flex-end; margin-top:10px;">
            <button id="applyEditLabels">Apply</button>
            <button id="cancelEditLabels" class="secondary">Cancel</button>
          </div>
        </div>
      </div>

    </main>
    <footer class="app-footer">
        <div class="footer-content">
            <div class="footer-nav">
                <a href="../../../index.html" class="back-link">‚Üê Back to Tool Selection</a>
            </div>
            <div class="footer-meta">
                <span class="meta-item">Created: 2025-11-06</span>
                <span class="separator">‚Ä¢</span>
                <span class="meta-item">Last Updated: 2025-02-23</span>
            </div>
            <div class="footer-citation">
                <div class="citation-label">Cite this tool:</div>
                <div class="citation-text">Baker, A. (2025). Chi-Square Test of Independence Tool. <em>Dr. Baker's Marketing Tools</em>. Retrieved from <a href="https://drbakermarketing.com/apps/hypothesis_testing/chisquare/main_chisquare.html" target="_blank">https://drbakermarketing.com/apps/hypothesis_testing/chisquare/main_chisquare.html</a></div>
            </div>
            <div class="footer-copyright">
                &copy; 2025 Andrew Baker. All rights reserved.
            </div>
        </div>
    </footer>
    <script src="../../../shared/js/csv_utils.js"></script>
    <script src="../../../shared/js/ui_utils.js"></script>
    <script src="../../../shared/js/stacked_bar_utils.js"></script>
    <script src="../../../shared/js/auth_tracking.js"></script>
    <script src="../../../shared/js/auth_bar.js"></script>
    <script src="../../../shared/js/quiz_utils.js"></script>
    <script src="chisquare_app.js"></script>
    <script src="chisquare_tutorial.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        initQuizButton('chisquare');
      });
    </script>
    <script>
      (function () {
        var created = document.getElementById('created-date');
        var modified = document.getElementById('modified-date');
        if (created) created.textContent = new Date('2025-11-06').toLocaleDateString();
        if (modified) modified.textContent = new Date().toLocaleDateString();
      })();
    </script>
  </body>
  </html>
